{% extends 'base.html' %}
{% block title %}{{ user.email }}: profile{% endblock %}

{% block head %}
    <!-- js for school map display -->
    <style>
      #map {
        width: 500px;
        height: 400px;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js"></script>

    <script>
        var school_coords = {{ school_coords|safe }};

        function initialize() {
            var mapCanvas = document.getElementById('map');
            var mapCenter = {lat:39.8282, lng:-98.5795} 
            var mapOptions = {
                center: mapCenter,
                zoom: 3,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            }
            var map = new google.maps.Map(mapCanvas, mapOptions);

            // for loop: for each school/address/lat&long from school_coords object, & place marker w info.
            for (school in school_coords) {
                var marker = new google.maps.Marker({
                position: {lat:school_coords.Lat, lng:school_coords.Lng},
                map: map,
                title: "School name"
                });
            }

        }
        google.maps.event.addDomListener(window, 'load', initialize);
    </script>

{% endblock %}

{% block content %}

<!-- Display basic user info -->
<h2>{{ user.email }}</h2>

<ul>
    <li>Your GPA: <span id="user-gpa">{{ user.gpa }}</span><br/>
        <!-- let user update gpa if needed -->
        <form method="post" id="update-gpa">
            Update your GPA: <input type="text" name="gpa" id="gpa" value="{{ user.gpa }}"><br/>
            <input type="submit" value="Update GPA">
        </form>
    </li>
    <li>Your LSAT score: <span id="user-lsat">{{ user.lsat }}</span><br/>
        <!-- let user update lsat score if needed -->
        <form method="post" id="update-lsat">
            Update your LSAT score: <input type="text" name="lsat" id="lsat" value="{{ user.lsat }}"><br/>
            <input type="submit" value="Update LSAT">
        </form>
    </li>
</ul>

<h3><a href="/school_query">Browse your law school matches</a></h3>

<!-- If user has added schools to their list, display that list -->
{% if school_list: %}

    <div id="map"></div>

    <h3>Your selected law schools</h3>
    <ul>
        {% for item in school_list %}
            <!-- Display key info for each school -->
            <li id="{{ item.school_id }}">
                <h3><a href="schools/{{ item.school_id }}">{{ item.school_name }}</a></h3>
                {{ item.address }}<br/>
                Admission chance: {{ item.admission_chance }}<br/>

                {% if item.app_submitted == 1 %}
                    Application completed!
                
                {% elif item.app_submitted == 0 %}
                    <!-- button to let user change app_submitted field to yes (boolean 1) -->
                    <input type="button" value="I submitted this application!" class="app-submitted" data-school-id="{{ item.school_id }}">
                {% endif %}
                <br/>

                <!-- let user remove school from their list/this display -->
                <input type="button" value="Remove from my list" class="school-remove" data-school-id-num="{{ item.school_id }}">

            </li>
        {% endfor %}
    </ul>

{% endif %}


{% endblock %}

{% block js %}
    <script src="/static/js/update_user_gpa.js"></script>
    <script src="/static/js/update_user_lsat.js"></script>
    <script src="/static/js/update_app_submission.js"></script>
    <script src="/static/js/remove_school.js"></script>
{% endblock %}